---
// src/pages/preview.astro
import fs from 'fs/promises';
import mjml2html from 'mjml';
import { marked } from 'marked';

// Tento kód je takmer rovnaký ako v build-email.js
// Používa rovnakú šablónu a obsah, ale zobrazí výsledok priamo na stránke
const mjmlTemplate = await fs.readFile('src/templates/NewsletterTemplate.mjml', 'utf-8');
const markdownContent = await fs.readFile('src/newsletters/2025-10-15_pokus/index.md', 'utf-8');
const htmlContent = marked.parse(markdownContent);
const finalMjml = mjmlTemplate.replace('<!-- CONTENT_SLOT -->', htmlContent);
const { html: finalHtml } = mjml2html(finalMjml);
---
<Fragment set:html={finalHtml} />